<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.4" />
<title>resourcemodel API documentation</title>
<meta name="description" content="The Resource Model …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>resourcemodel</code></h1>
</header>
<section id="section-intro">
<p>The Resource Model.</p>
<p>What resources are and how they are consumed
<a href="https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html">https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html</a></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;The Resource Model.

What resources are and how they are consumed
https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html
&#34;&#34;&#34;
import logging
import pandas as pd  # type: ignore
import numpy as np  # type: ignore
from base import Base
from modeldata import ModelData
from util import Log, set_dataframe
from typing import Union


class Resource(Base):
    &#34;&#34;&#34;Resource - Manages all the resources that are used in the model.

    This creates for all r resources, the list of attributes a

    This contains
    This uses https://realpython.com/documenting-python-code/
    docstrings using the NumPy/SciPy syntax
    Uses a modified standard project
    Uses https://www.sphinx-doc.org/en/master/ to generate the documentation

    Stores all in lxn levels and items:
        Resource. Attributes of each
        Costs. Of the resource
        Inventory. The current inventory level
        Safety stock. the minimum inventory level in days
        Average Demand. This is used for min stockpilg

    Need to be done do an economic order quantity that varies by level and item
        Economic Order Quantity. inv_eoc_ln_df
    &#34;&#34;&#34;

    # no variables here unless you want class variables the same across all
    # instances

    def __init__(
        self, data: ModelData, log_root: Log = None, type: str = None,
    ):
        &#34;&#34;&#34;Initialize the Resources.

        Does a read in
        &#34;&#34;&#34;
        # to pick up the description
        super().__init__(log_root=log_root)

        # create a sublogger if a root exists in the model
        self.log_root = log_root
        if log_root is not None:
            log = log_root.log_class(self)
        else:
            log = logging.getLogger(__name__)
        self.log = log

        &#34;&#34;&#34;Initialize the Resource object
        This uses the Frame object and populates it with default data unless yo
        override it
        &#34;&#34;&#34;
        self.log.debug(&#34;in %s&#34;, __name__)
        # initial inventory defaults to zero
        # need labels for later since we do not have access to model
        self.label = data.label

        if type is not None:
            # ignoring the type for now but will eventually link
            log.debug(f&#34;{type=}&#34;)

        # original self initialization code
        # if attr_na_df is None:
        #     attr_na_arr = np.array([[1, 2], [2, 3]])
        #     attr_na_df = pd.DataFrame(
        #         attr_na_arr,
        #         index=self.label[&#34;Resource n&#34;],
        #         columns=self.label[&#34;Res Attribute a&#34;],
        #     )
        # self.attr_na_arr = attr_na_df.values
        # self.attr_na_df = attr_na_df

        self.attr_na_arr = data.value[&#34;Resource n&#34;][&#34;Res Attr Data na&#34;]
        self.attr_na_df = set_dataframe(
            self.attr_na_arr,
            data.label,
            index=&#34;Resource n&#34;,
            columns=&#34;Res Attribute a&#34;,
        )
        self.attr_na_df.index.name = &#34;Resources n&#34;
        self.attr_na_df.columns.name = &#34;Res Attr a&#34;

        log.debug(f&#34;{self.attr_na_df=}&#34;)
        self.set_description(
            f&#34;{self.attr_na_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Attr Data na&#34;],
        )

        self.cost_ln_arr = data.value[&#34;Resource n&#34;][&#34;Pop Level Res Cost ln&#34;]
        self.cost_ln_df = self.res_dataframe(self.cost_ln_arr)
        log.debug(f&#34;{self.cost_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.cost_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Pop Level Res Cost ln&#34;],
        )

        self.inv_initial_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Initial ln&#34;
        ]
        self.inv_initial_ln_df = self.res_dataframe(self.inv_initial_ln_arr,)
        log.debug(f&#34;{self.inv_initial_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.inv_initial_ln_df=}&#34;.split(&#34;=&#34;)[0],
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Initial ln&#34;],
        )
        log.debug(f&#34;{self.description[&#39;inv_initial_ln_df&#39;]}&#34;)

        # be careful you want a copy here so inv_initial stays the same
        self.inventory_ln_df = self.inv_initial_ln_df.copy()
        log.debug(f&#34;Setting initial inventory {self.inventory_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.inventory_ln_df=}&#34;.split(&#34;=&#34;)[0],
            data.description[&#34;Resource n&#34;][&#34;Res Inventory ln&#34;],
        )

        self.inv_eoc_ln_arr = data.value[&#34;Resource n&#34;][&#34;Res Inventory EOC ln&#34;]
        log.debug(f&#34;{self.inv_eoc_ln_arr=}&#34;)
        self.inv_eoc_ln_df = self.res_dataframe(self.inv_eoc_ln_arr,)
        # ensure we don&#39;t have any non-zero numbers
        self.inv_eoc_ln_df[self.inv_eoc_ln_df &lt; 1] = 1
        log.debug(f&#34;{self.inv_eoc_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.inv_eoc_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory EOC ln&#34;],
        )
        log.debug(f&#34;{self.description[&#39;inv_eoc_ln_df&#39;]}&#34;)

        safety_stock_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Safety Stock ln&#34;
        ]
        self.safety_stock_ln_df = self.res_dataframe(safety_stock_ln_arr,)
        self.set_description(
            f&#34;{self.safety_stock_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Safety Stock ln&#34;],
        )

        self.average_demand_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Average Demand ln&#34;
        ]
        self.average_demand_ln_df = self.res_dataframe(
            self.average_demand_ln_arr
        )
        self.set_description(
            f&#34;{self.average_demand_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Average Demand ln&#34;],
        )

        self.stockpile_days_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Stockpile Days ln&#34;
        ]
        self.stockpile_days_ln_df = self.res_dataframe(
            self.stockpile_days_ln_arr
        )
        self.set_description(
            f&#34;{self.stockpile_days_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Stockpile Days ln&#34;],
        )

    def set_stockpile_days(self, days: Union[np.ndarray, int]):
        &#34;&#34;&#34;Set stockpile days for all resources.

        A helper function which spreads the days across all populations nad all
        columns
        &#34;&#34;&#34;
        log = self.log
        # https://numpy.org/doc/stable/reference/generated/numpy.empty_like.html
        if type(days) is int:
            self.stockpile_days_ln_arr = days * np.ones_like(
                self.inventory_ln_df
            )
        else:
            self.stockpile_days_ln_arr = days
        self.stockpile_days_ln_df[:] = self.stockpile_days_ln_arr
        log.debug(f&#34;{self.stockpile_days_ln_df=}&#34;)

        # need to do a dot product
        self.safety_stock_ln_arr = (
            self.average_demand_ln_arr * self.stockpile_days_ln_arr
        )
        # https://stackoverflow.com/questions/53375161/use-numpy-array-to-replace-pandas-dataframe-values
        self.safety_stock_ln_df[:] = self.safety_stock_ln_arr
        log.debug(f&#34;{self.safety_stock_ln_df=}&#34;)

        self.supply_order()

    def supply_order(self):
        &#34;&#34;&#34;Order from supplier.

        Always order up to the safety stock
        Does not calculate economic order quantity yet
        &#34;&#34;&#34;
        order_ln_df = self.safety_stock_ln_df - self.inventory_ln_df
        # negative means we have inventory above safety levels
        # so get rid of those
        # https://www.w3resource.com/python-exercises/numpy/python-numpy-exercise-90.php
        order_ln_df[order_ln_df &lt; 0] = 0
        # now gross up the order to the economic order quantity
        order_ln_df = self.round_up_to_eoc(order_ln_df)
        self.log.debug(&#34;supply order\n%s&#34;, order_ln_df)
        self.fulfill(order_ln_df)

    # https://stackoverflow.com/questions/2272149/round-to-5-or-other-number-in-python
    def round_up_to_eoc(self, order_ln_df):
        &#34;&#34;&#34;Round order up the economic order quantity.

        Roundup
        &#34;&#34;&#34;
        # So take the order and then get the distance to the eoc
        # by using modulo
        # https://stackoverflow.com/questions/50767452/check-if-dataframe-has-a-zero-element
        # https://numpy.org/doc/stable/reference/generated/numpy.any.html
        # https://softwareengineering.stackexchange.com/questions/225956/python-assert-vs-if-return
        # do not use asserts they are stripped with optimization, raise errors
        if np.any(self.inv_eoc_ln_df &lt; 1):
            raise ValueError(
                f&#34;EOC should never be less than 1 {self.inv_eoc_ln_df=}&#34;
            )

        if np.any(order_ln_df &lt; 0):
            raise ValueError(
                f&#34;Orders should be never be negative {order_ln_df=}&#34;
            )

        return (
            order_ln_df
            + (self.inv_eoc_ln_df - order_ln_df) % self.inv_eoc_ln_df
        )

    def fulfill(self, order_ln_df):
        &#34;&#34;&#34;Fulfill an order form supplier.

        This is a stub in that all orders are immediatley fulfilled
        &#34;&#34;&#34;
        self.log.debug(&#34;fulfilled immediately\n%s&#34;, order_ln_df)
        self.inventory_ln_df += order_ln_df
        self.log.debug(&#34;inventory\n%s&#34;, self.inventory_ln_df)

    def demand(self, demand_ln_df):
        &#34;&#34;&#34;Demand for resources.

        Take the demand and then return what you can
        In this simple model which you can override

        It will check what is in inventory and then call the delivery_fn method

        returns: whats available to ship
        &#34;&#34;&#34;
        # Return as much as we can
        deliver_ln_df = min(demand_ln_df, self.inventory_ln_df)
        self.inventory_ln_df -= deliver_ln_df

        # now restock
        self.supply_order()
        return deliver_ln_df

    def res_dataframe(self, arr: np.ndarray) -&gt; pd.DataFrame:
        &#34;&#34;&#34;Resource Model.

        Dataframe setting
        &#34;&#34;&#34;
        df = set_dataframe(
            arr, self.label, index=&#34;Pop Level l&#34;, columns=&#34;Resource n&#34;
        )
        return df</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="resourcemodel.Resource"><code class="flex name class">
<span>class <span class="ident">Resource</span></span>
<span>(</span><span>data: modeldata.ModelData, log_root: util.Log = None, type: str = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Resource - Manages all the resources that are used in the model.</p>
<p>This creates for all r resources, the list of attributes a</p>
<p>This contains
This uses <a href="https://realpython.com/documenting-python-code/">https://realpython.com/documenting-python-code/</a>
docstrings using the NumPy/SciPy syntax
Uses a modified standard project
Uses <a href="https://www.sphinx-doc.org/en/master/">https://www.sphinx-doc.org/en/master/</a> to generate the documentation</p>
<p>Stores all in lxn levels and items:
Resource. Attributes of each
Costs. Of the resource
Inventory. The current inventory level
Safety stock. the minimum inventory level in days
Average Demand. This is used for min stockpilg</p>
<p>Need to be done do an economic order quantity that varies by level and item
Economic Order Quantity. inv_eoc_ln_df</p>
<p>Initialize the Resources.</p>
<p>Does a read in</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Resource(Base):
    &#34;&#34;&#34;Resource - Manages all the resources that are used in the model.

    This creates for all r resources, the list of attributes a

    This contains
    This uses https://realpython.com/documenting-python-code/
    docstrings using the NumPy/SciPy syntax
    Uses a modified standard project
    Uses https://www.sphinx-doc.org/en/master/ to generate the documentation

    Stores all in lxn levels and items:
        Resource. Attributes of each
        Costs. Of the resource
        Inventory. The current inventory level
        Safety stock. the minimum inventory level in days
        Average Demand. This is used for min stockpilg

    Need to be done do an economic order quantity that varies by level and item
        Economic Order Quantity. inv_eoc_ln_df
    &#34;&#34;&#34;

    # no variables here unless you want class variables the same across all
    # instances

    def __init__(
        self, data: ModelData, log_root: Log = None, type: str = None,
    ):
        &#34;&#34;&#34;Initialize the Resources.

        Does a read in
        &#34;&#34;&#34;
        # to pick up the description
        super().__init__(log_root=log_root)

        # create a sublogger if a root exists in the model
        self.log_root = log_root
        if log_root is not None:
            log = log_root.log_class(self)
        else:
            log = logging.getLogger(__name__)
        self.log = log

        &#34;&#34;&#34;Initialize the Resource object
        This uses the Frame object and populates it with default data unless yo
        override it
        &#34;&#34;&#34;
        self.log.debug(&#34;in %s&#34;, __name__)
        # initial inventory defaults to zero
        # need labels for later since we do not have access to model
        self.label = data.label

        if type is not None:
            # ignoring the type for now but will eventually link
            log.debug(f&#34;{type=}&#34;)

        # original self initialization code
        # if attr_na_df is None:
        #     attr_na_arr = np.array([[1, 2], [2, 3]])
        #     attr_na_df = pd.DataFrame(
        #         attr_na_arr,
        #         index=self.label[&#34;Resource n&#34;],
        #         columns=self.label[&#34;Res Attribute a&#34;],
        #     )
        # self.attr_na_arr = attr_na_df.values
        # self.attr_na_df = attr_na_df

        self.attr_na_arr = data.value[&#34;Resource n&#34;][&#34;Res Attr Data na&#34;]
        self.attr_na_df = set_dataframe(
            self.attr_na_arr,
            data.label,
            index=&#34;Resource n&#34;,
            columns=&#34;Res Attribute a&#34;,
        )
        self.attr_na_df.index.name = &#34;Resources n&#34;
        self.attr_na_df.columns.name = &#34;Res Attr a&#34;

        log.debug(f&#34;{self.attr_na_df=}&#34;)
        self.set_description(
            f&#34;{self.attr_na_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Attr Data na&#34;],
        )

        self.cost_ln_arr = data.value[&#34;Resource n&#34;][&#34;Pop Level Res Cost ln&#34;]
        self.cost_ln_df = self.res_dataframe(self.cost_ln_arr)
        log.debug(f&#34;{self.cost_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.cost_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Pop Level Res Cost ln&#34;],
        )

        self.inv_initial_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Initial ln&#34;
        ]
        self.inv_initial_ln_df = self.res_dataframe(self.inv_initial_ln_arr,)
        log.debug(f&#34;{self.inv_initial_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.inv_initial_ln_df=}&#34;.split(&#34;=&#34;)[0],
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Initial ln&#34;],
        )
        log.debug(f&#34;{self.description[&#39;inv_initial_ln_df&#39;]}&#34;)

        # be careful you want a copy here so inv_initial stays the same
        self.inventory_ln_df = self.inv_initial_ln_df.copy()
        log.debug(f&#34;Setting initial inventory {self.inventory_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.inventory_ln_df=}&#34;.split(&#34;=&#34;)[0],
            data.description[&#34;Resource n&#34;][&#34;Res Inventory ln&#34;],
        )

        self.inv_eoc_ln_arr = data.value[&#34;Resource n&#34;][&#34;Res Inventory EOC ln&#34;]
        log.debug(f&#34;{self.inv_eoc_ln_arr=}&#34;)
        self.inv_eoc_ln_df = self.res_dataframe(self.inv_eoc_ln_arr,)
        # ensure we don&#39;t have any non-zero numbers
        self.inv_eoc_ln_df[self.inv_eoc_ln_df &lt; 1] = 1
        log.debug(f&#34;{self.inv_eoc_ln_df=}&#34;)
        self.set_description(
            f&#34;{self.inv_eoc_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory EOC ln&#34;],
        )
        log.debug(f&#34;{self.description[&#39;inv_eoc_ln_df&#39;]}&#34;)

        safety_stock_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Safety Stock ln&#34;
        ]
        self.safety_stock_ln_df = self.res_dataframe(safety_stock_ln_arr,)
        self.set_description(
            f&#34;{self.safety_stock_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Safety Stock ln&#34;],
        )

        self.average_demand_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Average Demand ln&#34;
        ]
        self.average_demand_ln_df = self.res_dataframe(
            self.average_demand_ln_arr
        )
        self.set_description(
            f&#34;{self.average_demand_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Average Demand ln&#34;],
        )

        self.stockpile_days_ln_arr = data.value[&#34;Resource n&#34;][
            &#34;Res Inventory Stockpile Days ln&#34;
        ]
        self.stockpile_days_ln_df = self.res_dataframe(
            self.stockpile_days_ln_arr
        )
        self.set_description(
            f&#34;{self.stockpile_days_ln_df=}&#34;,
            data.description[&#34;Resource n&#34;][&#34;Res Inventory Stockpile Days ln&#34;],
        )

    def set_stockpile_days(self, days: Union[np.ndarray, int]):
        &#34;&#34;&#34;Set stockpile days for all resources.

        A helper function which spreads the days across all populations nad all
        columns
        &#34;&#34;&#34;
        log = self.log
        # https://numpy.org/doc/stable/reference/generated/numpy.empty_like.html
        if type(days) is int:
            self.stockpile_days_ln_arr = days * np.ones_like(
                self.inventory_ln_df
            )
        else:
            self.stockpile_days_ln_arr = days
        self.stockpile_days_ln_df[:] = self.stockpile_days_ln_arr
        log.debug(f&#34;{self.stockpile_days_ln_df=}&#34;)

        # need to do a dot product
        self.safety_stock_ln_arr = (
            self.average_demand_ln_arr * self.stockpile_days_ln_arr
        )
        # https://stackoverflow.com/questions/53375161/use-numpy-array-to-replace-pandas-dataframe-values
        self.safety_stock_ln_df[:] = self.safety_stock_ln_arr
        log.debug(f&#34;{self.safety_stock_ln_df=}&#34;)

        self.supply_order()

    def supply_order(self):
        &#34;&#34;&#34;Order from supplier.

        Always order up to the safety stock
        Does not calculate economic order quantity yet
        &#34;&#34;&#34;
        order_ln_df = self.safety_stock_ln_df - self.inventory_ln_df
        # negative means we have inventory above safety levels
        # so get rid of those
        # https://www.w3resource.com/python-exercises/numpy/python-numpy-exercise-90.php
        order_ln_df[order_ln_df &lt; 0] = 0
        # now gross up the order to the economic order quantity
        order_ln_df = self.round_up_to_eoc(order_ln_df)
        self.log.debug(&#34;supply order\n%s&#34;, order_ln_df)
        self.fulfill(order_ln_df)

    # https://stackoverflow.com/questions/2272149/round-to-5-or-other-number-in-python
    def round_up_to_eoc(self, order_ln_df):
        &#34;&#34;&#34;Round order up the economic order quantity.

        Roundup
        &#34;&#34;&#34;
        # So take the order and then get the distance to the eoc
        # by using modulo
        # https://stackoverflow.com/questions/50767452/check-if-dataframe-has-a-zero-element
        # https://numpy.org/doc/stable/reference/generated/numpy.any.html
        # https://softwareengineering.stackexchange.com/questions/225956/python-assert-vs-if-return
        # do not use asserts they are stripped with optimization, raise errors
        if np.any(self.inv_eoc_ln_df &lt; 1):
            raise ValueError(
                f&#34;EOC should never be less than 1 {self.inv_eoc_ln_df=}&#34;
            )

        if np.any(order_ln_df &lt; 0):
            raise ValueError(
                f&#34;Orders should be never be negative {order_ln_df=}&#34;
            )

        return (
            order_ln_df
            + (self.inv_eoc_ln_df - order_ln_df) % self.inv_eoc_ln_df
        )

    def fulfill(self, order_ln_df):
        &#34;&#34;&#34;Fulfill an order form supplier.

        This is a stub in that all orders are immediatley fulfilled
        &#34;&#34;&#34;
        self.log.debug(&#34;fulfilled immediately\n%s&#34;, order_ln_df)
        self.inventory_ln_df += order_ln_df
        self.log.debug(&#34;inventory\n%s&#34;, self.inventory_ln_df)

    def demand(self, demand_ln_df):
        &#34;&#34;&#34;Demand for resources.

        Take the demand and then return what you can
        In this simple model which you can override

        It will check what is in inventory and then call the delivery_fn method

        returns: whats available to ship
        &#34;&#34;&#34;
        # Return as much as we can
        deliver_ln_df = min(demand_ln_df, self.inventory_ln_df)
        self.inventory_ln_df -= deliver_ln_df

        # now restock
        self.supply_order()
        return deliver_ln_df

    def res_dataframe(self, arr: np.ndarray) -&gt; pd.DataFrame:
        &#34;&#34;&#34;Resource Model.

        Dataframe setting
        &#34;&#34;&#34;
        df = set_dataframe(
            arr, self.label, index=&#34;Pop Level l&#34;, columns=&#34;Resource n&#34;
        )
        return df</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>base.Base</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="resourcemodel.Resource.log"><code class="name">var <span class="ident">log</span></code></dt>
<dd>
<div class="desc"><p>Initialize the Resource object
This uses the Frame object and populates it with default data unless yo
override it</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="resourcemodel.Resource.demand"><code class="name flex">
<span>def <span class="ident">demand</span></span>(<span>self, demand_ln_df)</span>
</code></dt>
<dd>
<div class="desc"><p>Demand for resources.</p>
<p>Take the demand and then return what you can
In this simple model which you can override</p>
<p>It will check what is in inventory and then call the delivery_fn method</p>
<p>returns: whats available to ship</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def demand(self, demand_ln_df):
    &#34;&#34;&#34;Demand for resources.

    Take the demand and then return what you can
    In this simple model which you can override

    It will check what is in inventory and then call the delivery_fn method

    returns: whats available to ship
    &#34;&#34;&#34;
    # Return as much as we can
    deliver_ln_df = min(demand_ln_df, self.inventory_ln_df)
    self.inventory_ln_df -= deliver_ln_df

    # now restock
    self.supply_order()
    return deliver_ln_df</code></pre>
</details>
</dd>
<dt id="resourcemodel.Resource.fulfill"><code class="name flex">
<span>def <span class="ident">fulfill</span></span>(<span>self, order_ln_df)</span>
</code></dt>
<dd>
<div class="desc"><p>Fulfill an order form supplier.</p>
<p>This is a stub in that all orders are immediatley fulfilled</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def fulfill(self, order_ln_df):
    &#34;&#34;&#34;Fulfill an order form supplier.

    This is a stub in that all orders are immediatley fulfilled
    &#34;&#34;&#34;
    self.log.debug(&#34;fulfilled immediately\n%s&#34;, order_ln_df)
    self.inventory_ln_df += order_ln_df
    self.log.debug(&#34;inventory\n%s&#34;, self.inventory_ln_df)</code></pre>
</details>
</dd>
<dt id="resourcemodel.Resource.res_dataframe"><code class="name flex">
<span>def <span class="ident">res_dataframe</span></span>(<span>self, arr: numpy.ndarray) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>Resource Model.</p>
<p>Dataframe setting</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def res_dataframe(self, arr: np.ndarray) -&gt; pd.DataFrame:
    &#34;&#34;&#34;Resource Model.

    Dataframe setting
    &#34;&#34;&#34;
    df = set_dataframe(
        arr, self.label, index=&#34;Pop Level l&#34;, columns=&#34;Resource n&#34;
    )
    return df</code></pre>
</details>
</dd>
<dt id="resourcemodel.Resource.round_up_to_eoc"><code class="name flex">
<span>def <span class="ident">round_up_to_eoc</span></span>(<span>self, order_ln_df)</span>
</code></dt>
<dd>
<div class="desc"><p>Round order up the economic order quantity.</p>
<p>Roundup</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def round_up_to_eoc(self, order_ln_df):
    &#34;&#34;&#34;Round order up the economic order quantity.

    Roundup
    &#34;&#34;&#34;
    # So take the order and then get the distance to the eoc
    # by using modulo
    # https://stackoverflow.com/questions/50767452/check-if-dataframe-has-a-zero-element
    # https://numpy.org/doc/stable/reference/generated/numpy.any.html
    # https://softwareengineering.stackexchange.com/questions/225956/python-assert-vs-if-return
    # do not use asserts they are stripped with optimization, raise errors
    if np.any(self.inv_eoc_ln_df &lt; 1):
        raise ValueError(
            f&#34;EOC should never be less than 1 {self.inv_eoc_ln_df=}&#34;
        )

    if np.any(order_ln_df &lt; 0):
        raise ValueError(
            f&#34;Orders should be never be negative {order_ln_df=}&#34;
        )

    return (
        order_ln_df
        + (self.inv_eoc_ln_df - order_ln_df) % self.inv_eoc_ln_df
    )</code></pre>
</details>
</dd>
<dt id="resourcemodel.Resource.set_stockpile_days"><code class="name flex">
<span>def <span class="ident">set_stockpile_days</span></span>(<span>self, days: Union[numpy.ndarray, int])</span>
</code></dt>
<dd>
<div class="desc"><p>Set stockpile days for all resources.</p>
<p>A helper function which spreads the days across all populations nad all
columns</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_stockpile_days(self, days: Union[np.ndarray, int]):
    &#34;&#34;&#34;Set stockpile days for all resources.

    A helper function which spreads the days across all populations nad all
    columns
    &#34;&#34;&#34;
    log = self.log
    # https://numpy.org/doc/stable/reference/generated/numpy.empty_like.html
    if type(days) is int:
        self.stockpile_days_ln_arr = days * np.ones_like(
            self.inventory_ln_df
        )
    else:
        self.stockpile_days_ln_arr = days
    self.stockpile_days_ln_df[:] = self.stockpile_days_ln_arr
    log.debug(f&#34;{self.stockpile_days_ln_df=}&#34;)

    # need to do a dot product
    self.safety_stock_ln_arr = (
        self.average_demand_ln_arr * self.stockpile_days_ln_arr
    )
    # https://stackoverflow.com/questions/53375161/use-numpy-array-to-replace-pandas-dataframe-values
    self.safety_stock_ln_df[:] = self.safety_stock_ln_arr
    log.debug(f&#34;{self.safety_stock_ln_df=}&#34;)

    self.supply_order()</code></pre>
</details>
</dd>
<dt id="resourcemodel.Resource.supply_order"><code class="name flex">
<span>def <span class="ident">supply_order</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Order from supplier.</p>
<p>Always order up to the safety stock
Does not calculate economic order quantity yet</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def supply_order(self):
    &#34;&#34;&#34;Order from supplier.

    Always order up to the safety stock
    Does not calculate economic order quantity yet
    &#34;&#34;&#34;
    order_ln_df = self.safety_stock_ln_df - self.inventory_ln_df
    # negative means we have inventory above safety levels
    # so get rid of those
    # https://www.w3resource.com/python-exercises/numpy/python-numpy-exercise-90.php
    order_ln_df[order_ln_df &lt; 0] = 0
    # now gross up the order to the economic order quantity
    order_ln_df = self.round_up_to_eoc(order_ln_df)
    self.log.debug(&#34;supply order\n%s&#34;, order_ln_df)
    self.fulfill(order_ln_df)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="resourcemodel.Resource" href="#resourcemodel.Resource">Resource</a></code></h4>
<ul class="two-column">
<li><code><a title="resourcemodel.Resource.demand" href="#resourcemodel.Resource.demand">demand</a></code></li>
<li><code><a title="resourcemodel.Resource.fulfill" href="#resourcemodel.Resource.fulfill">fulfill</a></code></li>
<li><code><a title="resourcemodel.Resource.log" href="#resourcemodel.Resource.log">log</a></code></li>
<li><code><a title="resourcemodel.Resource.res_dataframe" href="#resourcemodel.Resource.res_dataframe">res_dataframe</a></code></li>
<li><code><a title="resourcemodel.Resource.round_up_to_eoc" href="#resourcemodel.Resource.round_up_to_eoc">round_up_to_eoc</a></code></li>
<li><code><a title="resourcemodel.Resource.set_stockpile_days" href="#resourcemodel.Resource.set_stockpile_days">set_stockpile_days</a></code></li>
<li><code><a title="resourcemodel.Resource.supply_order" href="#resourcemodel.Resource.supply_order">supply_order</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.4</a>.</p>
</footer>
</body>
</html>
